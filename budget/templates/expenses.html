{% extends '__base_view__.html' %}
{% block title %}
  Wydatki
{% endblock %}
{% block body %}
  <div class="card">
    <div class="card-body">
      <form method="post" class="form-inline">
        {% csrf_token %}
        <label for="date" class="mr-sm-2">Data</label>
        <input type="date" id="date" name="date" class="form-control mb-2 mr-sm-2">
        <label for="amount" class="mr-sm-2">Kwota</label>
        <input type="number" step="0.01" id="amount" name="amount" class="form-control mb-2 mr-sm-2">
        <label for="category" class="mr-sm-2">Kategoria</label>
        <select id="category" name="category" class="form-control">
          {% for category in categories %}
            <option value="{{ category.id }}">{{ category.name }}</option>
          {% empty %}
            <option>Brak zdefiniowanych kategorii</option>
          {% endfor %}
        </select>
        <div class="form-group">
          <label for="comment" class="mr-sm-2">Komentarz</label>
          <textarea class="form-control mb-2 mr-sm-2" cols="40" rows="1" id="comment" name="comment"></textarea>
        </div>
        <button type="submit" class="btn btn-primary mb-2">Dodaj</button>
      </form>
    </div>
  </div>
  <div class="card">
    <div class="card-body">
      <form class="form-inline">
        <label for="date" class="mr-sm-2">Od</label>
        <input type="date" id="date" name="date_from" class="form-control mb-2 mr-sm-2">
        <label for="date" class="mr-sm-2">Do</label>
        <input type="date" id="date" name="date_for" class="form-control mb-2 mr-sm-2">
        <label for="category" class="mr-sm-2">Kategoria</label>
        <select id="category" name="selected_category" class="form-control mb-2 mr-sm-2">
          {% for category in categories %}
            <option value="{{ category.id }}">{{ category.name }}</option>
          {% empty %}
            <option>Brak zdefiniowanych kategorii</option>
          {% endfor %}
        </select>
        <button type="submit" class="btn btn-primary mb-2 mr-sm-2">Filtruj</button>
      </form>
      <table class="table table-borderless table-hover">
        <thead class="thead-dark">
        <tr>
          <th style="width: 13%">Data</th>
          <th style="width: 10%">Kwota</th>
          <th style="width: 10%">
            <form>
              <select id="selected_category" name="selected_category" class="form-control-sm">
                <option value="" selected>Wszystko</option>
                {% for category in categories %}
                  <option value="{{ category.id }}">{{ category.name }}</option>
                {% empty %}
                  <option>Brak zdefiniowanych kategorii</option>
                {% endfor %}
              </select>
            </form>
          </th>
          <th style="width: 67%">Opis</th>
        </tr>
        </thead>
        <tbody>
        {% for expense in expenses %}
          <tr>
            <td>{{ expense.date|date:"SHORT_DATE_FORMAT" }}</td>
            <td>{{ expense.amount }}</td>
            <td>{{ expense.category.name }}</td>
            <td>{{ expense.comment }}</td>
          </tr>
        {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

  <script>
    console.log($('#selected_category'));
    let category = document.getElementById('selected_category');
    category.addEventListener('change', function(event){
      let selected_category = JSON.stringify({'selected_category': event.currentTarget.value});
    });
  </script>

{% endblock %}